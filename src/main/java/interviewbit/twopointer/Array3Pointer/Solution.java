package interviewbit.twopointer.Array3Pointer;

import java.util.ArrayList;
import java.util.List;

/**
 * Created by karthikb on 04-07-2017.
 */
public class Solution {
	
	public int minimize(final List<Integer> a, final List<Integer> b, final List<Integer> c) {
		int i = 0;
		int aa,bb,cc;
		int ans = Integer.MAX_VALUE;
		for(i =0; i<a.size(); i++)
		{
			aa = a.get(i);
			bb = binarySearch(b,aa);
			cc = binarySearch(c,aa);
			ans = Math.min(Math.max(Math.max(Math.abs(aa-bb), Math.abs(aa-cc)),Math.abs(bb-cc)), ans);
		}
		for(i =0; i<b.size(); i++)
		{
			aa = b.get(i);
			bb = binarySearch(a,aa);
			cc = binarySearch(c,aa);
			ans = Math.min(Math.max(Math.max(Math.abs(aa-bb), Math.abs(aa-cc)),Math.abs(bb-cc)), ans);
		}
		for(i =0; i<c.size(); i++)
		{
			aa = c.get(i);
			bb = binarySearch(a,aa);
			cc = binarySearch(b,aa);
			ans = Math.min(Math.max(Math.max(Math.abs(aa-bb), Math.abs(aa-cc)),Math.abs(bb-cc)), ans);
		}
		return ans;
	}
	
	int binarySearch(List<Integer> a, int b)
	{
		int ans = a.get(0);
		int i=0, j = a.size()-1, mid;
		while(i < j)
		{
			mid = (i+j)/2;
			if(a.get(mid) == b)
			{
				return b;
			}
			else if(a.get(mid) < b)
			{
				ans = a.get(mid);
				i = mid+1;
			}
			else
			{
				j = mid;
			}
		}
		return ans;
	}
	
	public static void main(String[] args) {
		Solution sol = new Solution();
		
		int[] A = new int[] { 8, 49, 57, 120, 140, 160, 248, 353, 452, 462, 680, 695, 708, 739, 811, 837, 918, 938, 971, 990, 1027, 1050, 1075, 1096, 1104, 1114, 1184, 1252, 1292, 1302, 1320, 1337, 1389, 1392, 1513, 1560, 1619, 1731, 1813, 1880, 1881, 1885, 1896, 1990, 2059, 2075, 2121, 2228, 2271, 2271, 2396, 2410, 2411, 2492, 2493, 2553, 2563, 2663, 2727, 2793, 2983, 2984, 3097, 3136, 3232, 3270, 3824, 3883, 3891, 3926, 3930, 3943, 4061, 4076, 4203, 4234, 4242, 4273, 4290, 4302, 4316, 4443, 4510, 4728, 4844, 4848, 4902, 4953, 4987, 4998, 5020, 5061, 5109, 5134, 5216, 5310, 5319, 5342, 5424, 5523, 5568, 5574, 5596, 5597, 5682, 5687, 5832, 5881, 5908, 5928, 5984, 6178, 6302, 6352, 6375, 6435, 6556, 6592, 6613, 6644, 6674, 6685, 6742, 6867, 6891, 6923, 6974, 6975, 7023, 7075, 7101, 7131, 7181, 7197, 7321, 7390, 7400, 7449, 7454, 7558, 7658, 7729, 7750, 7760, 7852, 7856, 7873, 7950, 8012, 8125, 8158, 8160, 8202, 8521, 8534, 8590, 8630, 8658, 8689, 8714, 8755, 8765, 8779, 8795, 8837, 8874, 8946, 9082, 9085, 9121, 9148, 9161, 9177, 9301, 9310, 9348, 9366, 9428, 9458, 9474, 9501, 9504, 9586, 9603, 9605, 9663, 9802 };
		int[] B = new int[] { 4, 23, 60, 83, 91, 125, 127, 129, 147, 191, 220, 234, 259, 279, 340, 347, 388, 392, 407, 421, 425, 441, 473, 495, 511, 511, 515, 518, 522, 562, 591, 603, 665, 671, 694, 738, 753, 760, 778, 792, 800, 824, 870, 905, 906, 924, 985, 988, 1007, 1034, 1035, 1058, 1073, 1088, 1093, 1096, 1111, 1112, 1144, 1162, 1167, 1171, 1190, 1199, 1210, 1211, 1237, 1237, 1247, 1283, 1340, 1396, 1405, 1422, 1439, 1442, 1443, 1450, 1465, 1472, 1517, 1549, 1555, 1593, 1620, 1623, 1652, 1664, 1668, 1671, 1684, 1730, 1757, 1770, 1780, 1800, 1831, 1837, 1866, 1890, 1891, 1964, 2027, 2040, 2056, 2112, 2144, 2198, 2224, 2246, 2297, 2309, 2337, 2337, 2364, 2417, 2427, 2446, 2461, 2462, 2475, 2501, 2521, 2546, 2625, 2630, 2632, 2638, 2646, 2683, 2716, 2732, 2766, 2781, 2784, 2828, 2840, 2841, 2842, 2862, 2892, 2899, 2930, 2936, 2956, 2978, 2990, 3046, 3057, 3108, 3135, 3138, 3153, 3155, 3219, 3226, 3244, 3270, 3272, 3292, 3336, 3367, 3375, 3380, 3390, 3406, 3414, 3416, 3430, 3436, 3501, 3510, 3519, 3539, 3562, 3573, 3573, 3619, 3642, 3652, 3659, 3664, 3689, 3694, 3709, 3711, 3731, 3736, 3744, 3791, 3813, 3848, 3859, 3872, 3900, 3909, 3924, 3965, 3971, 3980, 3993, 4005, 4029, 4052, 4078, 4101, 4105, 4142, 4154, 4162, 4203, 4208, 4239, 4252, 4274, 4299, 4333, 4336, 4338, 4338, 4354, 4387, 4396, 4434, 4464, 4501, 4516, 4519, 4533, 4534, 4552, 4581, 4582, 4585, 4590, 4599, 4612, 4621, 4627, 4656, 4668, 4669, 4681, 4725, 4760, 4762, 4770, 4798, 4815, 4836, 4837, 4935, 4943, 4946, 4954, 4970, 4978, 4991, 5017, 5037, 5041, 5052, 5054, 5073, 5082, 5112, 5131, 5131, 5155, 5162, 5203, 5234, 5237, 5241, 5251, 5269, 5294, 5297, 5299, 5329, 5332, 5338, 5346, 5419, 5442, 5513, 5568, 5569, 5603, 5621, 5652, 5680, 5689, 5709, 5730, 5739, 5756, 5777, 5783, 5802, 5831, 5876, 5890, 5912, 5918, 5928, 5955, 5970, 5970, 5991, 6061, 6062, 6068, 6086, 6119, 6122, 6123, 6247, 6268, 6340, 6389, 6406, 6417, 6421, 6422, 6444, 6479, 6482, 6500, 6533, 6550, 6553, 6555, 6582, 6597, 6664, 6687, 6705, 6717, 6735, 6763, 6770, 6774, 6791, 6792, 6808, 6811, 6825, 6856, 6863, 6881, 6902, 6907, 6969, 7019, 7024, 7036, 7162, 7163, 7172, 7219, 7219, 7247, 7301, 7305, 7362, 7383, 7406, 7406, 7420, 7445, 7494, 7509, 7523, 7527, 7534, 7541, 7557, 7568, 7623, 7664, 7665, 7681, 7681, 7688, 7691, 7696, 7702, 7714, 7754, 7771, 7784, 7793, 7810, 7811, 7817, 7817, 7832, 7860, 7902, 7905, 7909, 7912, 7926, 7944, 7944, 7975, 8011, 8026, 8027, 8064, 8100, 8162, 8174, 8241, 8261, 8265, 8275, 8323, 8325, 8354, 8384, 8389, 8417, 8422, 8445, 8524, 8547, 8578, 8578, 8601, 8607, 8629, 8662, 8711, 8719, 8723, 8732, 8742, 8784, 8812, 8820, 8821, 8836, 8862, 8891, 8901, 8910, 8930, 8982, 8985, 8999, 9042, 9054, 9070, 9101, 9110, 9139, 9143, 9173, 9177, 9209, 9281, 9300, 9303, 9330, 9334, 9401, 9432, 9435, 9449, 9486, 9550, 9742, 9742, 9784, 9837, 9893, 9904, 9930, 9942, 9962, 9992 };
		int[] C = new int[] { 94, 128, 160, 220, 235, 249, 300, 393, 468, 487, 536, 548, 583, 587, 601, 601, 603, 659, 686, 713, 718, 765, 809, 898, 901, 917, 923, 945, 1074, 1112, 1151, 1194, 1233, 1286, 1288, 1314, 1322, 1347, 1403, 1411, 1519, 1614, 1724, 1768, 1824, 1842, 1862, 1877, 1896, 1966, 2061, 2067, 2071, 2094, 2097, 2102, 2104, 2129, 2235, 2284, 2312, 2395, 2434, 2587, 2649, 2655, 2674, 2729, 2758, 2839, 2869, 2902, 2909, 2955, 2960, 3005, 3034, 3043, 3081, 3132, 3152, 3158, 3175, 3177, 3183, 3284, 3332, 3341, 3378, 3428, 3458, 3501, 3515, 3541, 3561, 3574, 3587, 3664, 3684, 3725, 3734, 3744, 3792, 3902, 3931, 3936, 3947, 3979, 4045, 4058, 4064, 4181, 4208, 4262, 4278, 4342, 4415, 4654, 4678, 4747, 4833, 4864, 4901, 4939, 5041, 5064, 5092, 5137, 5140, 5146, 5205, 5220, 5226, 5229, 5322, 5359, 5376, 5428, 5452, 5512, 5533, 5547, 5567, 5672, 5745, 5801, 5802, 5843, 5852, 6068, 6072, 6128, 6140, 6175, 6187, 6190, 6216, 6277, 6306, 6438, 6455, 6495, 6569, 6607, 6609, 6634, 6692, 6739, 6752, 6784, 6825, 6829, 6855, 6862, 6899, 6965, 6976, 7001, 7067, 7087, 7161, 7208, 7252, 7290, 7351, 7420, 7433, 7435, 7435, 7522, 7581, 7647, 7712, 7731, 7749, 7782, 7827, 7839, 7845, 7854, 7893, 7933, 7938, 7969, 8009, 8176, 8228, 8253, 8253, 8276, 8289, 8309, 8323, 8330, 8332, 8343, 8356, 8385, 8391, 8425, 8518, 8572, 8623, 8627, 8635, 8635, 8661, 8715, 8716, 8719, 8776, 8802, 8825, 8830, 8841, 8853, 8884, 8903, 8905, 8907, 8985, 8995, 9018, 9039, 9077, 9093, 9141, 9191, 9214, 9242, 9344, 9444, 9488, 9594, 9602, 9610, 9622, 9640, 9646, 9650, 9705, 9706, 9711, 9760, 9780, 9799, 9813, 9876, 9913, 9937, 9968 };
		ArrayList<Integer> a = new ArrayList<>(A.length);
		for(int i=0; i<A.length; i++)
			a.add(A[i]);
		ArrayList<Integer> b = new ArrayList<>(B.length);
		for(int i=0; i<B.length; i++)
			b.add(B[i]);
		ArrayList<Integer> c = new ArrayList<>(C.length);
		for(int i=0; i<C.length; i++)
			c.add(C[i]);
		
		System.out.println(sol.minimize(a,b,c));
		
		A = new int[] { 11, 15, 27, 38, 38, 63, 88, 108, 113, 116, 118, 170, 176, 212, 257, 269, 298, 378, 409, 412, 416, 416, 422, 433, 466, 495, 500, 510, 516, 555, 566, 572, 590, 592, 602, 623, 630, 635, 640, 701, 720, 759, 761, 775, 788, 796, 802, 833, 858, 861, 890, 895, 896, 935, 937, 943, 966, 967, 969, 978, 991, 992, 1004, 1008, 1008, 1011, 1027, 1057, 1083, 1106, 1122, 1132, 1146, 1151, 1194, 1196, 1256, 1263, 1264, 1269, 1288, 1290, 1292, 1305, 1306, 1308, 1322, 1346, 1347, 1363, 1383, 1405, 1421, 1427, 1473, 1501, 1506, 1509, 1524, 1550, 1554, 1562, 1563, 1567, 1569, 1615, 1623, 1623, 1652, 1673, 1679, 1686, 1707, 1710, 1715, 1816, 1824, 1824, 1840, 1859, 1865, 1894, 1913, 1932, 1938, 1940, 1950, 1958, 1959, 1982, 1999, 2022, 2032, 2057, 2060, 2062, 2150, 2150, 2153, 2155, 2166, 2175, 2214, 2233, 2236, 2251, 2254, 2261, 2302, 2332, 2357, 2371, 2384, 2388, 2421, 2424, 2436, 2439, 2454, 2455, 2472, 2478, 2488, 2493, 2500, 2519, 2526, 2545, 2569, 2574, 2578, 2586, 2592, 2614, 2615, 2655, 2656, 2660, 2663, 2664, 2669, 2697, 2706, 2707, 2710, 2733, 2748, 2751, 2757, 2764, 2812, 2820, 2824, 2834, 2846, 2859, 2862, 2874, 2887, 2940, 2952, 2963, 2968, 2992, 3003, 3026, 3050, 3053, 3062, 3066, 3068, 3070, 3070, 3122, 3131, 3161, 3171, 3198, 3213, 3214, 3220, 3231, 3250, 3253, 3289, 3292, 3325, 3327, 3336, 3349, 3350, 3360, 3392, 3400, 3405, 3407, 3408, 3428, 3448, 3455, 3462, 3502, 3539, 3559, 3572, 3602, 3617, 3666, 3696, 3728, 3739, 3746, 3759, 3763, 3765, 3775, 3791, 3823, 3842, 3850, 3858, 3877, 3891, 3893, 3901, 3919, 3942, 3951, 3958, 3961, 3962, 3971, 3974, 3989, 4007, 4016, 4033, 4043, 4047, 4058, 4081, 4083, 4085, 4106, 4120, 4125, 4133, 4188, 4190, 4209, 4217, 4218, 4220, 4247, 4249, 4254, 4277, 4281, 4284, 4304, 4316, 4332, 4334, 4342, 4375, 4380, 4383, 4391, 4418, 4421, 4426, 4448, 4466, 4474, 4491, 4538, 4538, 4540, 4540, 4544, 4567, 4611, 4614, 4616, 4620, 4649, 4665, 4706, 4722, 4729, 4744, 4748, 4788, 4802, 4845, 4848, 4849, 4856, 4858, 4896, 4905, 4916, 4917, 4920, 4924, 4928, 4936, 4938, 4948, 4978, 4999, 5003, 5012, 5013, 5017, 5042, 5048, 5051, 5053, 5054, 5058, 5081, 5084, 5091, 5098, 5107, 5108, 5123, 5140, 5159, 5184, 5185, 5203, 5208, 5209, 5228, 5237, 5237, 5240, 5263, 5278, 5278, 5289, 5326, 5333, 5364, 5375, 5432, 5442, 5467, 5530, 5535, 5538, 5543, 5584, 5617, 5635, 5643, 5647, 5652, 5658, 5661, 5703, 5707, 5707, 5718, 5750, 5764, 5766, 5779, 5801, 5811, 5835, 5851, 5853, 5857, 5858, 5861, 5867, 5871, 5880, 5905, 5915, 5919, 5934, 5947, 5957, 5975, 5976, 5986, 6001, 6017, 6036, 6039, 6076, 6080, 6089, 6094, 6116, 6124, 6165, 6172, 6197, 6210, 6219, 6227, 6228, 6234, 6243, 6274, 6275, 6291, 6299, 6319, 6322, 6366, 6386, 6410, 6419, 6426, 6430, 6446, 6451, 6485, 6513, 6516, 6523, 6566, 6571, 6579, 6581, 6601, 6641, 6657, 6661, 6683, 6693, 6716, 6720, 6727, 6747, 6751, 6764, 6783, 6783, 6793, 6801, 6855, 6855, 6862, 6867, 6874, 6898, 6912, 6915, 6918, 6918, 6936, 6948, 6957, 6988, 7003, 7014, 7014, 7019, 7027, 7033, 7038, 7083, 7098, 7127, 7135, 7142, 7152, 7186, 7194, 7224, 7247, 7250, 7254, 7272, 7276, 7310, 7328, 7370, 7386, 7458, 7479, 7496, 7513, 7579, 7585, 7607, 7620, 7623, 7630, 7644, 7650, 7654, 7658, 7671, 7672, 7672, 7712, 7712, 7716, 7721, 7724, 7725, 7733, 7738, 7741, 7745, 7759, 7763, 7765, 7772, 7776, 7780, 7782, 7791, 7797, 7797, 7800, 7811, 7861, 7878, 7885, 7924, 7967, 7972, 7980, 7985, 8003, 8004, 8007, 8011, 8025, 8029, 8061, 8070, 8074, 8091, 8106, 8124, 8124, 8132, 8132, 8141, 8154, 8167, 8168, 8168, 8172, 8189, 8197, 8212, 8214, 8228, 8235, 8291, 8301, 8307, 8313, 8318, 8326, 8331, 8335, 8426, 8428, 8440, 8449, 8449, 8453, 8461, 8479, 8503, 8512, 8516, 8518, 8531, 8543, 8554, 8593, 8609, 8619, 8621, 8653, 8656, 8663, 8698, 8709, 8718, 8746, 8776, 8821, 8823, 8824, 8840, 8864, 8874, 8883, 8899, 8902, 8902, 8902, 8932, 8937, 8960, 8977, 8989, 9002, 9015, 9035, 9051, 9063, 9106, 9107, 9142, 9164, 9173, 9183, 9200, 9203, 9270, 9284, 9286, 9291, 9322, 9328, 9347, 9382, 9387, 9408, 9427, 9439, 9439, 9487, 9491, 9517, 9542, 9543, 9546, 9552, 9561, 9565, 9572, 9605, 9611, 9620, 9630, 9673, 9675, 9683, 9684, 9691, 9731, 9743, 9744, 9745, 9756, 9757, 9759, 9770, 9778, 9795, 9800, 9837, 9855, 9869, 9893, 9895, 9911, 9964, 9981, 9983, 9987 };
		B = new int[] { 35, 56, 59, 75, 96, 224, 236, 249, 267, 291, 307, 310, 416, 417, 423, 436, 445, 461, 462, 478, 486, 524, 544, 553, 627, 644, 657, 663, 682, 684, 695, 736, 756, 761, 766, 782, 788, 832, 898, 898, 905, 915, 946, 952, 1001, 1038, 1081, 1084, 1094, 1098, 1124, 1129, 1170, 1178, 1194, 1217, 1254, 1267, 1270, 1281, 1284, 1322, 1322, 1346, 1386, 1418, 1426, 1456, 1524, 1531, 1608, 1609, 1619, 1637, 1669, 1684, 1696, 1699, 1718, 1752, 1761, 1778, 1817, 1850, 1874, 1891, 1899, 1937, 1943, 1945, 1948, 1968, 1973, 1979, 1987, 2008, 2010, 2024, 2079, 2130, 2140, 2164, 2185, 2204, 2259, 2271, 2282, 2283, 2284, 2363, 2410, 2452, 2472, 2484, 2487, 2493, 2494, 2497, 2524, 2579, 2583, 2584, 2589, 2603, 2603, 2608, 2628, 2641, 2645, 2666, 2705, 2723, 2732, 2750, 2751, 2762, 2772, 2782, 2798, 2820, 2854, 2861, 2903, 2925, 2950, 2978, 2987, 3075, 3118, 3131, 3189, 3201, 3206, 3212, 3243, 3274, 3283, 3297, 3308, 3361, 3392, 3396, 3417, 3418, 3419, 3420, 3433, 3437, 3443, 3444, 3467, 3495, 3509, 3562, 3597, 3615, 3618, 3621, 3631, 3689, 3742, 3756, 3757, 3757, 3774, 3782, 3797, 3842, 3863, 3921, 3933, 3937, 3952, 3980, 3985, 4011, 4016, 4040, 4055, 4063, 4094, 4125, 4140, 4146, 4148, 4180, 4200, 4201, 4211, 4226, 4236, 4260, 4281, 4293, 4295, 4318, 4340, 4525, 4528, 4537, 4601, 4628, 4652, 4658, 4690, 4696, 4701, 4729, 4749, 4758, 4760, 4789, 4793, 4824, 4826, 4840, 4912, 4926, 4931, 4954, 5092, 5095, 5138, 5143, 5179, 5181, 5203, 5222, 5267, 5276, 5277, 5288, 5292, 5334, 5362, 5410, 5416, 5448, 5450, 5469, 5554, 5618, 5648, 5722, 5749, 5750, 5781, 5790, 5791, 5815, 5873, 5906, 5921, 5984, 5990, 6014, 6039, 6046, 6078, 6124, 6130, 6139, 6155, 6155, 6226, 6251, 6255, 6257, 6265, 6274, 6290, 6317, 6322, 6326, 6333, 6347, 6366, 6379, 6386, 6403, 6415, 6418, 6443, 6470, 6485, 6495, 6508, 6543, 6581, 6602, 6603, 6640, 6664, 6666, 6677, 6681, 6683, 6690, 6693, 6734, 6740, 6749, 6768, 6779, 6784, 6835, 6861, 6866, 6879, 6895, 6928, 6935, 6951, 6973, 6975, 7020, 7020, 7044, 7108, 7135, 7147, 7164, 7181, 7205, 7235, 7237, 7256, 7256, 7259, 7266, 7283, 7290, 7342, 7380, 7387, 7388, 7428, 7441, 7481, 7540, 7551, 7569, 7595, 7647, 7652, 7699, 7708, 7728, 7749, 7749, 7771, 7834, 7860, 7869, 7944, 7951, 7969, 7974, 8000, 8000, 8007, 8017, 8020, 8025, 8041, 8043, 8052, 8070, 8082, 8115, 8130, 8141, 8154, 8188, 8206, 8221, 8329, 8366, 8384, 8403, 8417, 8434, 8440, 8462, 8493, 8496, 8497, 8530, 8562, 8604, 8615, 8625, 8639, 8654, 8666, 8669, 8688, 8725, 8744, 8753, 8755, 8780, 8813, 8829, 8833, 8846, 8857, 8873, 8889, 8921, 8929, 8937, 8945, 8973, 9027, 9028, 9029, 9042, 9069, 9101, 9115, 9155, 9161, 9192, 9220, 9230, 9244, 9257, 9263, 9287, 9316, 9317, 9350, 9381, 9448, 9492, 9508, 9574, 9659, 9664, 9714, 9726, 9740, 9741, 9744, 9752, 9770, 9780, 9789, 9816, 9833, 9838, 9871, 9880, 9889, 9892, 9910, 9946, 9963, 9982, 10000 };
		C = new int[] { 57, 139, 157, 168, 186, 231, 268, 336, 354, 359, 371, 372, 449, 454, 471, 516, 522, 535, 614, 772, 818, 1032, 1124, 1136, 1160, 1181, 1195, 1343, 1427, 1536, 1624, 1757, 1767, 1774, 1801, 1959, 2021, 2028, 2065, 2095, 2117, 2209, 2303, 2306, 2343, 2383, 2445, 2475, 2534, 2546, 2553, 2708, 2947, 2969, 3087, 3153, 3170, 3194, 3209, 3219, 3270, 3349, 3403, 3444, 3465, 3487, 3601, 3730, 3744, 3769, 3830, 3867, 3924, 3931, 4064, 4144, 4156, 4217, 4218, 4467, 4518, 4597, 4706, 4772, 4816, 4841, 4981, 4995, 5034, 5060, 5117, 5123, 5124, 5245, 5314, 5400, 5473, 5565, 5703, 5769, 5771, 6029, 6138, 6200, 6264, 6280, 6304, 6468, 6728, 6791, 6798, 6846, 6890, 6926, 7019, 7128, 7286, 7331, 7383, 7400, 7433, 7576, 7710, 7796, 7852, 8116, 8165, 8303, 8368, 8513, 8517, 8527, 8603, 8626, 8686, 8703, 8763, 8807, 8865, 8886, 9024, 9110, 9119, 9154, 9185, 9335, 9390, 9564, 9588, 9589, 9627, 9677, 9691, 9766, 9816, 9873, 9942 };
		
		a = new ArrayList<>(A.length);
		for(int i=0; i<A.length; i++)
			a.add(A[i]);
		b = new ArrayList<>(B.length);
		for(int i=0; i<B.length; i++)
			b.add(B[i]);
		c = new ArrayList<>(C.length);
		for(int i=0; i<C.length; i++)
			c.add(C[i]);
		
		System.out.println(sol.minimize(a,b,c));
	}
}
